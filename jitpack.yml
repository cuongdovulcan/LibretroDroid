jdk:
  - openjdk11

before_install:
  - echo "Starting JitPack build for LibretroDroid"
  - chmod +x ./gradlew || true

install:
  # Initialize git submodules
  - echo "Initializing git submodules..."
  - git submodule update --init --recursive || echo "Warning: Submodule init had issues"
  
  # Build only the library module (skip app module and tests)
  - echo "Building libretrodroid library..."
  - ./gradlew :libretrodroid:clean :libretrodroid:assembleRelease -x test -x lint --no-daemon --stacktrace
  
  # Verify build output
  - echo "Build completed. Checking outputs..."
  - find libretrodroid/build/outputs -name "*.aar" -type f || echo "No AAR found"
  - ls -la libretrodroid/build/outputs/aar/ 2>/dev/null || echo "AAR directory check"
